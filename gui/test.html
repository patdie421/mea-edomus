<!DOCTYPE html>
<html>
    <head>
       <meta charset="utf-8" />
       <title>Socket.io</title>
    </head>

    <body>
       <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
       <h1 id='titre'>Tentative de communication avec socket.io : </h1>
       <div id="info"></div>

       <script>
          function socketio_available() { // socket io est charg√©, on se connecte

             var socketio_addr=window.location.protocol + '//' + window.location.hostname + ':8000';
             var socket = io.connect(socketio_addr);

             socket.on('log', function(message) {
                $("#info").append("<div>LOG : "+message+"</div>");
             });
          }

          function socketio_unavailable(jqXHR, textStatus, errorThrown) {
             jqXHR.abort();
             $("#info").text("Pas d'iosocket on va faire sans ...");
          }

          $(document).ready(function() {
             var socketiojs_url=window.location.protocol + '//' + window.location.hostname + ':8000/socket.io/socket.io.js';

             $('#titre').append(socketiojs_url);

             $.ajax({
                url: socketiojs_url,
                dataType: "script",
                timeout: 5000,
                success: socketio_available,
                error: socketio_unavailable,
             });
          });
       </script>
    </body>
</html>

